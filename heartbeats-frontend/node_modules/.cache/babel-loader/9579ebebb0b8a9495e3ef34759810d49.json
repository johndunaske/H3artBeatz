{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/johnduna/Documents/GitHub/H3artBeatz/heartbeats-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"/Users/johnduna/Documents/GitHub/H3artBeatz/heartbeats-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/johnduna/Documents/GitHub/H3artBeatz/heartbeats-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/johnduna/Documents/GitHub/H3artBeatz/heartbeats-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/johnduna/Documents/GitHub/H3artBeatz/heartbeats-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import GraphComponent from\"./GraphComponent\";import defaultImage from\"../Assets/testImage.jpg\";import TopBar from\"./TopBar\";import SpotifyPlayer from\"react-spotify-web-playback\";// props:\n// signout: function to remove spotify auth token cookie\n// token: spotify token\n// fPlaylist: favorite playlist\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var socket;var count=0;var HomePage=/*#__PURE__*/function(_React$Component){_inherits(HomePage,_React$Component);var _super=_createSuper(HomePage);function HomePage(props){var _this;_classCallCheck(this,HomePage);_this=_super.call(this,props);_this.getTracks=function(){var url=\"https://api.spotify.com/v1/playlists/\".concat(_this.state.favoritePlaylistId,\"/tracks\");fetch(url,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+_this.props.token}}).then(function(response){return response.json();}).then(function(data){var temp=[];var _iterator=_createForOfIteratorHelper(data.items),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;temp.push(i);}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.setState({tracks:temp});});};_this.componentDidMount=function(){socket=new WebSocket(\"ws://h3artbeatz.herokuapp.com/websocket\");socket.addEventListener(\"open\",function(event){console.log(\"Websocket Connected!\");});socket.addEventListener(\"message\",function(event){var data=\"\";try{data=JSON.parse(event.data)[\"BPM\"];}catch(e){}var newList=[];if(_this.state.avg.length<15){newList=_this.state.avg.concat([data]);_this.setState({avg:newList});}if(_this.state.avg.length>=15){var sum=0;for(var i=0;i<15;i++){sum+=_this.state.avg[i];}var avgVal=sum/15;_this.setState({avgCalc:avgVal});}if(count>20){var newList=_this.state.hrReadings.concat([data]);var lastX=_this.state.xAxis[_this.state.xAxis.length-1];var newX=_this.state.xAxis.concat(_this.state.xAxis[lastX]);_this.setState({hrReadings:newList});_this.setState({xAxis:lastX});count=0;}count++;});socket.addEventListener(\"close\",function(event){console.log(\"Websocket Disconnected!\");});if(_this.state.favoritePlaylistId!=null&&_this.state.favoritePlaylistLink!=null){var tracksVar=_this.getTracks();_this.setState({tracks:tracksVar});}};_this.displayAlbum=function(state){if(state&&state.track&&state.track.image){_this.setState({albumCover:state.track.image});}};_this.state={favoritePlaylistLink:_this.props.fPlaylist!=null?_this.props.fPlaylist.uri:\"spotify:artist:6HQYnRM4OzToCYPpVBInuU\",favoritePlaylistId:_this.props.fPlaylist!=null?_this.props.fPlaylist.id:null,albumCover:defaultImage,avg:[],avgCalc:0,hrReadings:[100],xAxis:[0],tracks:[]};return _this;}_createClass(HomePage,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"mainContent\",children:[/*#__PURE__*/_jsx(TopBar,{logout:this.props.signout}),/*#__PURE__*/_jsx(\"div\",{className:\"albumContainer\",children:/*#__PURE__*/_jsx(\"img\",{className:\"albumCover\",src:this.state.albumCover,alt:defaultImage})}),/*#__PURE__*/_jsx(GraphComponent,{}),/*#__PURE__*/_jsx(SpotifyPlayer,{token:this.props.token,callback:this.displayAlbum,uris:[this.state.favoritePlaylistLink],styles:{bgColor:\"#000\",sliderColor:\"#ff6384\",trackArtistColor:\"#fff\",trackNameColor:\"#fff\",color:\"#fff\"}})]});}}]);return HomePage;}(React.Component);export{HomePage as default};","map":{"version":3,"sources":["/Users/johnduna/Documents/GitHub/H3artBeatz/heartbeats-frontend/src/Components/HomePage.jsx"],"names":["React","GraphComponent","defaultImage","TopBar","SpotifyPlayer","socket","count","HomePage","props","getTracks","url","state","favoritePlaylistId","fetch","method","headers","token","then","response","json","data","temp","items","i","push","setState","tracks","componentDidMount","WebSocket","addEventListener","event","console","log","JSON","parse","e","newList","avg","length","concat","sum","avgVal","avgCalc","hrReadings","lastX","xAxis","newX","favoritePlaylistLink","tracksVar","displayAlbum","track","image","albumCover","fPlaylist","uri","id","signout","bgColor","sliderColor","trackArtistColor","trackNameColor","color","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport GraphComponent from \"./GraphComponent\";\nimport defaultImage from \"../Assets/testImage.jpg\";\nimport TopBar from \"./TopBar\";\nimport SpotifyPlayer from \"react-spotify-web-playback\";\n\n// props:\n// signout: function to remove spotify auth token cookie\n// token: spotify token\n// fPlaylist: favorite playlist\n\nvar socket;\nvar count = 0;\nexport default class HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      favoritePlaylistLink:\n        this.props.fPlaylist != null\n          ? this.props.fPlaylist.uri\n          : \"spotify:artist:6HQYnRM4OzToCYPpVBInuU\",\n      favoritePlaylistId:\n        this.props.fPlaylist != null ? this.props.fPlaylist.id : null,\n      albumCover: defaultImage,\n      avg: [],\n      avgCalc: 0,\n      hrReadings: [100],\n      xAxis: [0],\n      tracks:[],\n    };\n  }\n\n  getTracks = () => {\n    var url = `https://api.spotify.com/v1/playlists/${this.state.favoritePlaylistId}/tracks`\n    fetch(url, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + this.props.token,\n      }\n    }).then((response) => response.json())\n    .then(data => {\n      let temp = [];\n      for (let i of data.items) {\n        temp.push(i);\n      }\n      this.setState({tracks:temp});\n    })\n  }\n\n  componentDidMount = () => {\n    socket = new WebSocket(\"ws://h3artbeatz.herokuapp.com/websocket\");\n\n    socket.addEventListener(\"open\", (event) => {\n      console.log(\"Websocket Connected!\");\n    });\n\n    socket.addEventListener(\"message\", (event) => {\n      var data = \"\"\n      try {\n        data = JSON.parse(event.data)[\"BPM\"];\n      } catch(e) {\n        \n      }\n       \n      var newList =[];\n      if (this.state.avg.length < 15) {\n        newList = this.state.avg.concat([data]);\n        this.setState({avg:newList});\n      }\n      if (this.state.avg.length >= 15) {\n        var sum = 0;\n        for (var i = 0; i < 15; i++) {\n          sum += this.state.avg[i]\n        }\n        var avgVal = sum / 15\n        this.setState({avgCalc: avgVal});\n      }\n      if (count > 20) {\n        var newList = this.state.hrReadings.concat([data]);\n        var lastX = this.state.xAxis[this.state.xAxis.length - 1]\n        var newX = this.state.xAxis.concat(this.state.xAxis[lastX])\n        this.setState({hrReadings:newList});\n        this.setState({xAxis:lastX});\n        count = 0;\n      }\n\n      count++;\n    });\n\n    socket.addEventListener(\"close\", (event) => {\n      console.log(\"Websocket Disconnected!\");\n    });\n\n    if (this.state.favoritePlaylistId != null && this.state.favoritePlaylistLink != null) {\n      let tracksVar = this.getTracks();\n      this.setState({tracks: tracksVar});\n    }\n  };\n\n  displayAlbum = (state) => {\n    if (state && state.track && state.track.image) {\n      this.setState({ albumCover: state.track.image });\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"mainContent\">\n        <TopBar logout={this.props.signout} />\n        <div className=\"albumContainer\">\n          <img\n            className=\"albumCover\"\n            src={this.state.albumCover}\n            alt={defaultImage}\n          ></img>\n        </div>\n        <GraphComponent />\n        <SpotifyPlayer\n          token={this.props.token}\n          callback={this.displayAlbum}\n          uris={[this.state.favoritePlaylistLink]}\n          styles={{\n            bgColor: \"#000\",\n            sliderColor: \"#ff6384\",\n            trackArtistColor: \"#fff\",\n            trackNameColor: \"#fff\",\n            color: \"#fff\",\n          }}\n        />\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}